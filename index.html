<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Народное такси</title>
  <style>
    html, body, #map {
      height: 100%;
      margin: 0;
      padding: 0;
    }
    #roleSelect {
      margin: 10px;
      font-size: 16px;
    }
    .info-box {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      background: rgba(255, 255, 255, 0.9);
      padding: 15px;
      font-size: 14px;
      max-height: 30%;
      overflow-y: auto;
    }
    .role-box {
      position: absolute;
      top: 10px;
      left: 10px;
      background: rgba(255, 255, 255, 0.8);
      padding: 10px;
      border-radius: 5px;
    }
  </style>
</head>
<body>
  <div class="role-box">
    <label for="roleSelect">Выберите роль: </label>
    <select id="roleSelect">
      <option value="driver">Водитель</option>
      <option value="passenger">Пассажир</option>
    </select>
  </div>

  <div id="map"></div>
  <div class="info-box" id="infoBox">
    <b>Информация о поездке:</b>
    <div id="info"></div>
  </div>

  <script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU&apikey=20981a8c-b8ac-4af3-a0ff-7d13b7dfd0ae" type="text/javascript"></script>
  <script>
    ymaps.ready(init);

    let map, driverStartMarker, driverEndMarker, passengerStartMarker, passengerEndMarker;
    let driverRoute, passengerRoute;

    function init() {
      map = new ymaps.Map("map", {
        center: [54.7, 21.0], // Центрируем на Калининград
        zoom: 12
      });

      // Выбираем начальную роль как "водитель"
      let currentRole = 'driver';
      updateMap(currentRole);

      // Слушаем изменение роли
      document.getElementById('roleSelect').addEventListener('change', function() {
        currentRole = this.value;
        updateMap(currentRole);
      });
    }

    function updateMap(role) {
      // Удаляем старые маркеры и маршруты
      if (driverStartMarker) driverStartMarker.destroy();
      if (driverEndMarker) driverEndMarker.destroy();
      if (passengerStartMarker) passengerStartMarker.destroy();
      if (passengerEndMarker) passengerEndMarker.destroy();
      if (driverRoute) driverRoute.destroy();
      if (passengerRoute) passengerRoute.destroy();

      // В зависимости от роли выставляем маркеры и маршруты
      if (role === 'driver') {
        // Маркеры водителя
        driverStartMarker = new ymaps.Placemark([54.7, 21.0], {
          balloonContent: "Старт водителя"
        }, {
          iconLayout: 'default#image',
          iconImageHref: 'https://img.icons8.com/ios/452/car.png', // Иконка машины
          iconImageSize: [30, 30],
          iconImageOffset: [-15, -15]
        });
        driverEndMarker = new ymaps.Placemark([54.8, 21.1], {
          balloonContent: "Финиш водителя"
        });

        map.geoObjects.add(driverStartMarker);
        map.geoObjects.add(driverEndMarker);

        driverRoute = new ymaps.Polyline([
          [54.7, 21.0],
          [54.8, 21.1]
        ], {}, {
          strokeColor: "#0000FF",
          strokeWidth: 4,
          strokeOpacity: 0.7
        });
        map.geoObjects.add(driverRoute);
      } else if (role === 'passenger') {
        // Маркеры пассажира
        passengerStartMarker = new ymaps.Placemark([54.7, 21.0], {
          balloonContent: "Старт пассажира"
        }, {
          iconLayout: 'default#image',
          iconImageHref: 'https://img.icons8.com/ios/452/user.png', // Иконка человека
          iconImageSize: [30, 30],
          iconImageOffset: [-15, -15]
        });
        passengerEndMarker = new ymaps.Placemark([54.75, 21.05], {
          balloonContent: "Финиш пассажира"
        });

        map.geoObjects.add(passengerStartMarker);
        map.geoObjects.add(passengerEndMarker);

        passengerRoute = new ymaps.Polyline([
          [54.7, 21.0],
          [54.75, 21.05]
        ], {}, {
          strokeColor: "#00FF00",
          strokeWidth: 4,
          strokeOpacity: 0.7
        });
        map.geoObjects.add(passengerRoute);
      }

      // Отображение информации о поездке
      const infoBox = document.getElementById("info");
      if (role === 'driver') {
        infoBox.innerHTML = `
          <div><b>Водитель:</b> Иван Иванов (@ivan)<br>
          Телефон: +7 900 000-00-00<br>
          Машина: Toyota Corolla, стаж: 5 лет</div>
        `;
      } else {
        infoBox.innerHTML = `
          <div><b>Пассажир:</b> Алексей Смирнов (@alexey)<br>
          Телефон: +7 900 111-11-11</div>
        `;
      }
    }
  </script>
</body>
</html>
